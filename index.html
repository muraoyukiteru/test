<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3×3 Image Sheet – A4 / 63×88mm / Guide</title>
  <style>
    :root{
      --gap: 0mm; /* 指定: 画像の間は空白なし */
      --cell-w: 63mm;
      --cell-h: 88mm;
      --grid-w: calc(var(--cell-w) * 3);
      --grid-h: calc(var(--cell-h) * 3);
    }
    *{ box-sizing: border-box; }
    html,body{ height:100%; margin:0; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic UI", "Meiryo", sans-serif;
      background: #f5f7fb;
      color: #111;
    }
    header{ position:sticky; top:0; z-index:10; background:#fff; border-bottom:1px solid #e5e7eb; }
    .toolbar{ max-width:1100px; margin:0 auto; padding:10px 16px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .btn{ appearance:none; background:#111; color:#fff; border:none; padding:10px 14px; border-radius:10px; font-weight:600; cursor:pointer; }
    .btn.secondary{ background:#e5e7eb; color:#111; }
    .field{ display:flex; align-items:center; gap:8px; padding:6px 10px; background:#fff; border:1px solid #e5e7eb; border-radius:10px; }
    .field input[type="text"]{ width:420px; max-width:70vw; }

    main{ max-width:1100px; margin:18px auto 60px; padding:0 16px; }

    /* A4表示: 210mm × 297mm 比率。画面では比率維持、印刷時は実寸。 */
    .a4-wrap{ display:grid; place-items:center; }
    .a4{ width:min(96vw, calc(96vh * (210/297))); aspect-ratio:210/297; background:#fff; box-shadow:0 10px 30px rgba(0,0,0,.08); border-radius:6px; position:relative; overflow:hidden; }

    /* 3x3グリッド（中央配置、線なし、隙間なし） */
    .sheet{ position:absolute; left:50%; top:50%; width:var(--grid-w); height:var(--grid-h); transform:translate(-50%, -50%); display:grid; grid-template-columns: repeat(3, var(--cell-w)); grid-template-rows: repeat(3, var(--cell-h)); gap: var(--gap); }
    .cell{ width:var(--cell-w); height:var(--cell-h); background:#fff; overflow:hidden; }
    .cell img{ width:100%; height:100%; display:block; object-fit:contain; background:#fff; }

    /* 周囲のガイド線（点線） */
    .sheet::before{ content:""; position:absolute; inset:0; border:1.2pt dashed #111; pointer-events:none; }

    footer{ text-align:center; color:#6b7280; font-size:12px; padding:24px; }

    /* 印刷（A4実寸） */
    @page { size: A4 portrait; margin: 0; }
    @media print{
      body{ background:#fff; }
      header, footer{ display:none; }
      .a4{ width:210mm; height:297mm; box-shadow:none; border-radius:0; }
    }
  </style>
</head>
<body>
  <header>
    <div class="toolbar" role="toolbar" aria-label="Controls">
      <button class="btn" id="applyBtn">9個のURLを反映</button>
      <button class="btn secondary" id="sampleBtn">サンプルURLを入れる</button>
      <label class="field" title="画像のフィット方法">
        <span>フィット:</span>
        <select id="fitMode">
          <option value="contain" selected>余白優先（切り抜きなし）</option>
          <option value="cover">全面優先（はみ出しカット）</option>
        </select>
      </label>
      <button class="btn" onclick="window.print()">🖨️ 印刷</button>
    </div>
  </header>

  <main>
    <section style="display:grid; gap:8px; margin-bottom:14px;">
      <details open>
        <summary style="cursor:pointer; font-weight:700;">画像URL（9個・JPEG推奨）</summary>
        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:8px; margin-top:10px;">
          <input class="url" type="url" placeholder="URL 1" />
          <input class="url" type="url" placeholder="URL 2" />
          <input class="url" type="url" placeholder="URL 3" />
          <input class="url" type="url" placeholder="URL 4" />
          <input class="url" type="url" placeholder="URL 5" />
          <input class="url" type="url" placeholder="URL 6" />
          <input class="url" type="url" placeholder="URL 7" />
          <input class="url" type="url" placeholder="URL 8" />
          <input class="url" type="url" placeholder="URL 9" />
        </div>
        <div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
          <label class="field" style="flex:1 1 auto;">
            <span>まとめ貼り付け</span>
            <input id="bulk" type="text" placeholder="9行で貼り付け（改行区切り）" />
          </label>
          <button class="btn secondary" id="bulkApply">分配</button>
        </div>
        <p style="margin:6px 0 0; font-size:12px; color:#6b7280;">※ 63×88mm の枠に等倍で入れます。既定は「切り抜きなし（余白あり）」です。画像の間隔は 0mm、枠線は無し。外周に点線のガイドを表示します。</p>
      </details>
    </section>

    <div class="a4-wrap">
      <div class="a4">
        <div id="sheet" class="sheet" aria-label="3x3 image grid">
          <!-- 9 cells -->
          <div class="cell"><img alt="1" /></div>
          <div class="cell"><img alt="2" /></div>
          <div class="cell"><img alt="3" /></div>
          <div class="cell"><img alt="4" /></div>
          <div class="cell"><img alt="5" /></div>
          <div class="cell"><img alt="6" /></div>
          <div class="cell"><img alt="7" /></div>
          <div class="cell"><img alt="8" /></div>
          <div class="cell"><img alt="9" /></div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    背景は白のA4。3×3グリッド（63×88mm）を中央配置。外周のみ点線ガイド。印刷は余白0推奨。
  </footer>

  <script>
    const SHEET = document.getElementById('sheet');
    const URL_INPUTS = Array.from(document.querySelectorAll('input.url'));
    const APPLY = document.getElementById('applyBtn');
    const SAMPLE = document.getElementById('sampleBtn');
    const BULK = document.getElementById('bulk');
    const BULK_APPLY = document.getElementById('bulkApply');
    const FIT = document.getElementById('fitMode');

    function applyFit(){
      SHEET.querySelectorAll('img').forEach(img=>{ img.style.objectFit = FIT.value; });
    }

    FIT.addEventListener('change', applyFit);

    function setImages(urls){
      const imgs = SHEET.querySelectorAll('img');
      imgs.forEach((img,i)=>{
        const u = urls[i] || '';
        img.src = u;
      });
    }

    APPLY.addEventListener('click', ()=>{
      const urls = URL_INPUTS.map(i=>i.value.trim());
      if (urls.filter(Boolean).length !== 9) {
        if (!confirm('9個すべてのURLが埋まっていません。空欄は表示されません。続行しますか？')) return;
      }
      setImages(urls);
    });

    BULK_APPLY.addEventListener('click', ()=>{
      const lines = BULK.value.split(/\n|\r/).map(s=>s.trim()).filter(Boolean);
      for(let i=0;i<URL_INPUTS.length;i++){
        URL_INPUTS[i].value = lines[i] || URL_INPUTS[i].value;
      }
    });

    SAMPLE.addEventListener('click', ()=>{
      const sample = [
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047394_P_KUNUGIDAMA.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047393_P_BAKUFOON.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047392_P_HINOARASHI.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047394_P_KUNUGIDAMA.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047393_P_BAKUFOON.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047392_P_HINOARASHI.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047394_P_KUNUGIDAMA.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047393_P_BAKUFOON.jpg',
        'https://www.pokemon-card.com/assets/images/card_images/large/SV10/047392_P_HINOARASHI.jpg',
      ];
      URL_INPUTS.forEach((inp,i)=> inp.value = sample[i] || '');
      setImages(sample);
    });

    // 初期状態: フィット適用
    applyFit();
  </script>
</body>
</html>
